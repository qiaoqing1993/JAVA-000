学习笔记
#字节码 
.class文件由几部分组成：

|指令|含义|       
|----|-----|
|魔数magic number|用来区分文件类型|
|version||
|constant pool|字面量 符号引用，字面量如文本字符串，java中声明为final的常量值等等，而符号引用如类和接口的全局限名，字段的名称和描述符，方法的名称和描述符|
|access_flag|访问标志|
||类名|
###Java bytecode
单字节指令，最多支持256个。Java指令=操作码opcode+操作数
|指令|含义|       
|----|-----|    
|load|局部变量入栈|
|store|变量出栈到局部变量表|
|push|常量入栈|
|dup|复制栈顶元素|
|pop|删除栈顶元素|
|add||
|sub||
|mul||
|div||
|invokevirtual|指令用于调用对象的实例方法，根据对象的实际类型进行分派|
|invokeinterface|指令用于调用接口方法，它会在运行时搜索一个实现了这个接口方法的对象，找出适合的方法进行调用|
|invokespecial|指令用于调用一些需要特殊处理的实例方法，包括实例初始化方法init、私有方法和父类方法|
|invokestatic|指令用于调用类方法（static方法）|
|invokedynamic|指令用于在运行时动态解析出调用点限定符所引用的方法，并执行该方法.|
|ifeq iflt ifle ifne|条件分支指令|
|goto goto_w jsr jsr_w ret|无条件分支指令|
#类生命周期
- 加载 寻找class文件
- 校验 验证格式、依赖
- 准备 静态字段、方法表
- 解析 符号解析为引用
- 初始化 构造器 静态变量赋值 静态代码块执行 
- 使用 
- 卸载
###类的加载时机
1. 当虚拟机启动时，初始化用户指定的主类，就是启动执行的main 方法所在的类；
2. 当遇到用以新建目标类实例的new 指令时，初始化new 指令的目标类，就是new一个类的时候要初始化；
3. 当遇到调用静态方法的指令时，初始化该静态方法所在的类；
4. 当遇到访问静态字段的指令时，初始化该静态字段所在的类；
5. 子类的初始化会触发父类的初始化；
6. 如果一个接口定义了default 方法，那么直接实现或者间接实现该接口的类的初始化，会触发该接口的初始化；
7. 使用反射API 对某个类进行反射调用时，初始化这个类，其实跟前面一样，反射调用要么是已经有实例了，要么是静态方法，都需要初始化；
8. 当初次调用MethodHandle 实例时，初始化该MethodHandle 指向的方法所在的类。
#JMM
线程栈（方法栈 调用栈）
#GC算法
##串行
##并行
##CMS
##G1 
- 垃圾优先 
- 每次只清理回收集里的垃圾，垃圾最多的小块优先处理
- G1之前的回收算法，触发时间是某个区写满or某个对象无法存放，G1之后可以按阈值启动，该阈值会按照历史统计数据自行调整，优化自身行为
- G1 触发full GC时，会退回为串行GC，GC 暂停时间增长为秒级别

|参数|含义|默认值|备注|
|----|-----|-----|----|
|-XX：G1NewSizePercent|初始年轻代占整个Java Heap 的大小|默认5%||
|-XX：G1MaxNewSizePercent|最大年轻代占整个Java Heap 的大小|默认60%||
|-XX：G1HeapRegionSize|设置每个Region 的大小，单位MB，需要为1，2，4，8，16，32 中的某个值|堆内存的1/2000|如果这个值设置比较大，那么大对象就可以进入Region 了。|
|-XX：ConcGCThreads|与Java 应用一起执行的GC 线程数量|默认是Java 线程的1/4|减少这个参数的数值可能会提升并行回收的效率，提高系统内部吞吐量。如果这个数值过低，参与回收垃圾的线程不足，也会导致并行回收机制耗时加长|
|-XX：+InitiatingHeapOccupancyPercent（简称IHOP）|G1 内部并行回收循环启动的阈值|默认为Java Heap的45%|这个可以理解为老年代使用大于等于45% 的时候，JVM 会启动垃圾回收。这个值非常重要，它决定了在什么时间启动老年代的并行回收。|
|-XX：G1HeapWastePercent|G1停止回收的最小内存大小|堆大小的5%||
|-XX：+GCTimeRatio|这个参数就是计算花在Java 应用线程上和花在GC 线程上的时间比率|默认是9，跟新生代内存的分 配比例一致|
 |-XX：MaxGCPauseMills|预期G1 每次执行GC 操作的暂停时间，单位是毫秒|默认值是200 毫秒|
 
 ###G1处理
 1、年轻代模式转移暂停（Evacuation Pause）
 2、并发标记（Concurrent Marking） 类似CMS：
 3、 转移暂停：混合模式（Evacuation Pause (mixed)）
 